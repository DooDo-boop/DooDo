<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DooDo â€” Custom Shapes Test</title>
  <style>
    body {
      margin: 0;
      background: #E594BF;
      overflow: hidden;
      touch-action: none;
      font-family: sans-serif;
    }
    #palette {
      display: flex;
      flex-wrap: wrap;
      background: white;
      padding: 8px;
      gap: 6px;
    }
    .shape-icon, .color-swatch {
      width: 32px;
      height: 32px;
      border: 2px solid #ccc;
      border-radius: 4px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    .color-swatch {
      border-radius: 50%;
    }
    #canvas {
      width: 100vw;
      height: calc(100vh - 60px);
      position: relative;
      overflow: hidden;
    }
    .canvas-shape {
      position: absolute;
      touch-action: none;
      user-select: none;
      transform-origin: center;
    }
  </style>
</head>
<body>
  <div id="palette">
    <!-- Shape Icons -->
    <div class="shape-icon" data-shape="circle">âšª</div>
    <div class="shape-icon" data-shape="rect">â¬œ</div>
    <div class="shape-icon" data-shape="triangle">ğŸ”º</div>
    <div class="shape-icon" data-shape="ArrowRight">â¡ï¸</div>
    <div class="shape-icon" data-shape="Petal">ğŸŒ¸</div>
    <div class="shape-icon" data-shape="Octadecagon">ğŸ”·</div>
    <div class="shape-icon" data-shape="Flower">ğŸ’®</div>
    <div class="shape-icon" data-shape="Doll">ğŸ§¸</div>
    <div class="shape-icon" data-shape="Arch">ğŸ›ï¸</div>
    <div class="shape-icon" data-shape="Hexagon4">ğŸ›‘</div>
    <div class="shape-icon" data-shape="Comb">ğŸ¯</div>
    <div class="shape-icon" data-shape="Zigzag">ã€°ï¸</div>
    <div class="shape-icon" data-shape="DoubleStar">ğŸŒŸ</div>

    <!-- Colors -->
    <div class="color-swatch" data-color="rgba(237,28,36,0.56)" style="background:rgba(237,28,36,0.56); border:2px solid #000;"></div>
    <div class="color-swatch" data-color="#2E3192" style="background:#2E3192;"></div>
    <div class="color-swatch" data-color="#FAF073" style="background:#FAF073;"></div>
  </div>

  <div id="canvas"></div>

  <script>
    const canvas = document.getElementById('canvas');
    let selectedColor = 'rgba(237,28,36,0.56)';
    let selectedShape = null;

    const shapeSVGs = {
      circle: '<svg width="100" height="100"><circle cx="50" cy="50" r="48" /></svg>',
      rect: '<svg width="100" height="100"><rect width="100" height="100"/></svg>',
      triangle: '<svg width="100" height="100"><polygon points="50,0 100,100 0,100"/></svg>',
      ArrowRight: 'custom_shapes/ArrowRight.svg',
      Petal: 'custom_shapes/Petal.svg',
      Octadecagon: 'custom_shapes/Octadecagon.svg',
      Flower: 'custom_shapes/Flower.svg',
      Doll: 'custom_shapes/Doll.svg',
      Arch: 'custom_shapes/Arch.svg',
      Hexagon4: 'custom_shapes/Hexagon4.svg',
      Comb: 'custom_shapes/Comb.svg',
      Zigzag: 'custom_shapes/Zigzag.svg',
      DoubleStar: 'custom_shapes/DoubleStar.svg'
    };

    document.querySelectorAll('.color-swatch').forEach(swatch => {
      swatch.addEventListener('click', () => {
        document.querySelectorAll('.color-swatch').forEach(x => x.style.border = '2px solid #ccc');
        swatch.style.border = '2px solid #000';
        selectedColor = swatch.dataset.color;
        if (selectedShape) {
          const shapeEl = selectedShape.querySelector('svg > *');
          if (shapeEl) shapeEl.setAttribute('fill', selectedColor);
        }
      });
    });

    document.querySelectorAll('.shape-icon').forEach(icon => {
      icon.addEventListener('click', () => {
        const shapeKey = icon.dataset.shape;
        createShape(shapeKey);
      });
    });

    function createShape(shapeKey) {
      const div = document.createElement('div');
      div.className = 'canvas-shape';
      div.style.left = '100px';
      div.style.top = '100px';
      div.style.transform = 'translate(0, 0) scale(1)';
      if (shapeKey in shapeSVGs) {
        const value = shapeSVGs[shapeKey];
        if (value.endsWith('.svg')) {
          const img = document.createElement('img');
          img.src = value;
          img.style.width = '100px';
          img.style.height = '100px';
          img.style.filter = `drop-shadow(0 0 0 ${selectedColor}) saturate(0%)`;
          div.appendChild(img);
        } else {
          div.innerHTML = value;
          const shapeEl = div.querySelector('svg > *');
          if (shapeEl) shapeEl.setAttribute('fill', selectedColor);
        }
      }
      makeDraggable(div);
      canvas.appendChild(div);
      selectedShape = div;
    }

    function makeDraggable(el) {
      let offsetX, offsetY, dragging = false;
      el.addEventListener('pointerdown', e => {
        dragging = true;
        offsetX = e.clientX - el.offsetLeft;
        offsetY = e.clientY - el.offsetTop;
        el.setPointerCapture(e.pointerId);
      });
      el.addEventListener('pointermove', e => {
        if (!dragging) return;
        el.style.left = (e.clientX - offsetX) + 'px';
        el.style.top = (e.clientY - offsetY) + 'px';
      });
      el.addEventListener('pointerup', e => {
        dragging = false;
        el.releasePointerCapture(e.pointerId);
      });
    }
  </script>
</body>
</html>